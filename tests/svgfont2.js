const xml = require("xml");

function convertJsonToSvg(json) {
  const unicodeGlyphMapping = {
    "&#xEA01;": "a",
    "&#xEA02;": "b",
    "&#xEA03;": "c",
  };

  const glyphs = Object.keys(json).map((unicode) => {
    const glyphName = unicodeGlyphMapping[unicode];
    return {
      glyph: {
        _attr: {
          "glyph-name": glyphName,
          unicode: unicode,
          "horiz-adv-x": "1000",
          d: json[unicode],
        },
      },
    };
  });

  const svgObject = {
    svg: [
      {
        _attr: {
          xmlns: "http://www.w3.org/2000/svg",
        },
      },
      {
        defs: [
          {
            font: [
              {
                _attr: {
                  id: "font-custom",
                  "horiz-adv-x": "1000",
                },
              },
              {
                "font-face": {
                  _attr: {
                    "font-family": "font-custom",
                    "units-per-em": "1000",
                    ascent: "1000",
                    descent: "0",
                  },
                },
              },
              {
                "missing-glyph": {
                  _attr: {
                    "horiz-adv-x": "0",
                  },
                },
              },
              ...glyphs,
            ],
          },
        ],
      },
    ],
  };

  return xml(svgObject, { declaration: true, indent: "  " });
}

const jsonInput = {
  "&#xEA01;":
    "M291.6666666666667 500H708.3333333333335M333.3333333333334 645.8333333333333C333.3333333333334 645.8333333333333 375 625 416.6666666666668 625C479.1666666666667 625 520.8333333333334 666.6666666666666 583.3333333333334 666.6666666666666C625.0000000000001 666.6666666666666 666.6666666666667 645.8333333333333 666.6666666666667 645.8333333333333M333.3333333333334 354.1666666666665C333.3333333333334 354.1666666666665 375 333.3333333333333 416.6666666666668 333.3333333333333C479.1666666666667 333.3333333333333 520.8333333333334 374.9999999999999 583.3333333333334 374.9999999999999C625.0000000000001 374.9999999999999 666.6666666666667 354.1666666666665 666.6666666666667 354.1666666666665M875 500C875 292.8916666666667 707.1083333333333 125 500 125C292.8933333333334 125 125 292.8916666666667 125 500C125 707.1066666666666 292.8933333333334 875 500 875C707.1083333333333 875 875 707.1066666666666 875 500z",
  "&#xEA02;":
    "M125 250H291.6666666666667M416.6666666666668 250H875M208.3333333333334 125H500M666.6666666666667 125H791.6666666666667M366.6666666666668 374.9999999999999C256.2095833333334 374.9999999999999 166.6666666666667 460.5583333333333 166.6666666666667 566.0958333333333C166.6666666666667 653.56875 233.3333333333333 734.375 333.3333333333334 750C364.70125 821.9154166666667 438.9416666666666 875 525.5291666666667 875C636.4458333333333 875 727.0999999999999 792.0533333333333 733.3333333333335 687.5C792.1958333333333 662.6829166666666 833.3333333333335 601.7745833333333 833.3333333333335 535.8249999999999C833.3333333333335 447.0041666666666 758.7125000000001 374.9999999999999 666.6666666666667 374.9999999999999L366.6666666666668 374.9999999999999z",
};

const svgOutput = convertJsonToSvg(jsonInput);
console.log(svgOutput);
